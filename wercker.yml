box: golang

build:
  steps:
    # Sets the go workspace and places you package
    # at the right place in the workspace tree
    - setup-go-workspace

    # Build the project
    - script:
        name: Build
        code: |
          go build ./...

    - script:
        name: Get dependencies
        code: |
          go get -u github.com/mattn/goveralls
          go get -u github.com/golang/lint/golint

    # golint
    - wercker/golint

    - script:
        name: go tool vet
        code: |
          go tool vet .

    - script:
        name: gofmt
        code: |
          if [[ -n $(gofmt -l .) ]]; then echo "Please run gofmt"; exit 1; fi

    # Test the project
    - script:
        name: Test
        code: |
          go test -v -cover -coverprofile=coverage.out ./sudoku

    - script:
        name: Coveralls.io
        code: |
          goveralls -service='wercker.com' -repotoken=$COVERALLS_TOKEN -coverprofile=coverage.out